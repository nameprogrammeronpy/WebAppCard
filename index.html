
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>–í—ã–±–æ—Ä –∫–∞—Ä—Ç –¢–∞—Ä–æ</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            /* üé® –§–û–ù: –ó–∞–º–µ–Ω–∏ –Ω–∞ —Å–≤–æ–π –≥—Ä–∞–¥–∏–µ–Ω—Ç –∏–ª–∏ –∫–∞—Ä—Ç–∏–Ω–∫—É */
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            /* –î–ª—è –∫–∞—Ä—Ç–∏–Ω–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–π:
            background: url('images/background.jpg') center/cover no-repeat;
            */

            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            font-family: 'Georgia', serif;
            overflow-x: hidden;
            overflow-y: auto;
            padding: 15px 10px;
        }

        .container {
            text-align: center;
            position: relative;
            width: 100%;
            max-width: 450px;
        }

        .title {
            color: #e6b980;
            font-size: 20px;
            margin-bottom: 20px;
            text-shadow: 0 0 20px rgba(230, 185, 128, 0.5);
            animation: fadeIn 0.5s ease-in;
        }

        /* === –ê–ù–ò–ú–ê–¶–ò–Ø –ü–ï–†–ï–¢–ê–°–û–í–ö–ò === */
        .shuffle-area {
            position: relative;
            height: 250px;
            width: 100%;
            margin-bottom: 20px;
            display: block;
        }

        .shuffle-area.hidden {
            display: none !important;
            opacity: 0 !important;
            visibility: hidden !important;
        }

        .shuffle-card {
            position: absolute;
            width: 80px;
            height: 120px;

            /* üé¥ –†–£–ë–ê–®–ö–ê –ö–ê–†–¢–´: –ó–∞–º–µ–Ω–∏ –Ω–∞ —Å–≤–æ—é –∫–∞—Ä—Ç–∏–Ω–∫—É */
            background: linear-gradient(135deg, #2d1b4e 0%, #1a0f2e 100%);
            /* –î–ª—è –∫–∞—Ä—Ç–∏–Ω–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–π:
            background: url('images/card-back.png') center/cover no-repeat;
            */

            border: 2px solid #8b6f47;
            border-radius: 8px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 36px;
        }

        @keyframes shuffle1 {
            0%, 100% { left: 50%; top: 50%; transform: translate(-50%, -50%) rotate(0deg); opacity: 1; }
            50% { left: 20%; top: 20%; transform: translate(-50%, -50%) rotate(-25deg); opacity: 0.8; }
        }
        @keyframes shuffle2 {
            0%, 100% { left: 50%; top: 50%; transform: translate(-50%, -50%) rotate(0deg); opacity: 1; }
            50% { left: 80%; top: 30%; transform: translate(-50%, -50%) rotate(35deg); opacity: 0.8; }
        }
        @keyframes shuffle3 {
            0%, 100% { left: 50%; top: 50%; transform: translate(-50%, -50%) rotate(0deg); opacity: 1; }
            50% { left: 30%; top: 70%; transform: translate(-50%, -50%) rotate(-40deg); opacity: 0.8; }
        }
        @keyframes shuffle4 {
            0%, 100% { left: 50%; top: 50%; transform: translate(-50%, -50%) rotate(0deg); opacity: 1; }
            50% { left: 70%; top: 75%; transform: translate(-50%, -50%) rotate(28deg); opacity: 0.8; }
        }
        @keyframes shuffle5 {
            0%, 100% { left: 50%; top: 50%; transform: translate(-50%, -50%) rotate(0deg); opacity: 1; }
            50% { left: 50%; top: 15%; transform: translate(-50%, -50%) rotate(-15deg); opacity: 0.8; }
        }

        .shuffle-card:nth-child(1) { animation: shuffle1 1.2s ease-in-out infinite; }
        .shuffle-card:nth-child(2) { animation: shuffle2 1.2s ease-in-out infinite; animation-delay: 0.1s; }
        .shuffle-card:nth-child(3) { animation: shuffle3 1.2s ease-in-out infinite; animation-delay: 0.2s; }
        .shuffle-card:nth-child(4) { animation: shuffle4 1.2s ease-in-out infinite; animation-delay: 0.3s; }
        .shuffle-card:nth-child(5) { animation: shuffle5 1.2s ease-in-out infinite; animation-delay: 0.4s; }

        /* === –°–ï–¢–ö–ê 3√ó3 (–ê–î–ê–ü–¢–ò–í–ù–ê–Ø) === */
        .grid {
            display: none;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            perspective: 1000px;
            width: 100%;
            max-width: 400px;
            margin: 0 auto;
        }

        .grid.show {
            display: grid;
            animation: fadeIn 0.5s ease-in;
        }

        /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è 3D –ø–µ—Ä–µ–≤–æ—Ä–æ—Ç–∞ */
        .card-container {
            width: 100%;
            aspect-ratio: 2/3;
            position: relative;
            cursor: pointer;
            transform-style: preserve-3d;
            transition: transform 0.6s;
        }

        .card-container.flipped {
            transform: rotateY(180deg);
        }

        .card-container.selected {
            animation: pulse 0.5s ease-in-out;
        }

        .card-container.locked {
            pointer-events: none;
            opacity: 0.5;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1) rotateY(180deg); }
            50% { transform: scale(1.08) rotateY(180deg); }
        }

        /* –†—É–±–∞—à–∫–∞ –∏ –ª–∏—Ü–æ –∫–∞—Ä—Ç—ã */
        .card-back, .card-front {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 8px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px solid #8b6f47;
        }

        /* –†—É–±–∞—à–∫–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤–∏–¥–Ω–∞) */
        .card-back {
            /* üé¥ –†–£–ë–ê–®–ö–ê –í –°–ï–¢–ö–ï: –ó–∞–º–µ–Ω–∏ –Ω–∞ —Å–≤–æ—é –∫–∞—Ä—Ç–∏–Ω–∫—É */
            background: linear-gradient(135deg, #2d1b4e 0%, #1a0f2e 100%);
            /* –î–ª—è –∫–∞—Ä—Ç–∏–Ω–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–π:
            background: url('images/card-back.png') center/cover no-repeat;
            */

            font-size: 28px;
            transition: all 0.3s ease;
        }

        .card-container:active .card-back {
            box-shadow: 0 10px 30px rgba(230, 185, 128, 0.4);
            border-color: #e6b980;
        }

        /* –õ–∏—Ü–æ –∫–∞—Ä—Ç—ã (–∏–∑–Ω–∞—á–∞–ª—å–Ω–æ —Å–∫—Ä—ã—Ç–æ) */
        .card-front {
            background: linear-gradient(135deg, #4a2c5e 0%, #2d1b4e 100%);
            transform: rotateY(180deg);
            font-size: 36px;
            position: relative;
            overflow: hidden;
        }

        /* üÉè –ò–ó–û–ë–†–ê–ñ–ï–ù–ò–ï –ö–ê–†–¢–´ –¢–ê–†–û */
        .card-front img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 6px;
        }

        /* –ï—Å–ª–∏ –∫–∞—Ä—Ç–∏–Ω–∫–∏ –Ω–µ—Ç - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —ç–º–æ–¥–∑–∏ */
        .card-front .emoji-placeholder {
            font-size: 36px;
        }

        /* –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö */
        .card-container.selected .card-front {
            box-shadow: 0 0 25px rgba(230, 185, 128, 0.9),
                        0 0 40px rgba(230, 185, 128, 0.6);
            border-color: #e6b980;
        }

        .card-number {
            position: absolute;
            bottom: 4px;
            right: 6px;
            color: #e6b980;
            font-size: 11px;
            opacity: 0.9;
            font-weight: bold;
            text-shadow: 0 0 5px rgba(0, 0, 0, 0.8);
            z-index: 10;
        }

        /* –°–æ–æ–±—â–µ–Ω–∏–µ */
        .message {
            color: #e6b980;
            font-size: 15px;
            margin-top: 15px;
            min-height: 22px;
            animation: fadeIn 0.5s ease-in;
        }

        .message.success {
            font-size: 17px;
            font-weight: bold;
            text-shadow: 0 0 15px rgba(230, 185, 128, 0.7);
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* –ò—Å–∫—Ä—ã */
        .sparkle {
            position: absolute;
            width: 3px;
            height: 3px;
            background: #e6b980;
            border-radius: 50%;
            pointer-events: none;
            animation: sparkleFloat 2s ease-in-out infinite;
        }

        @keyframes sparkleFloat {
            0%, 100% { opacity: 0; transform: translateY(0) scale(0); }
            50% { opacity: 1; transform: translateY(-40px) scale(1); }
        }

        /* –§–∏–Ω–∞–ª—å–Ω—ã–π —ç–∫—Ä–∞–Ω */
        .final-screen {
            display: none;
            text-align: center;
            animation: fadeIn 0.8s ease-in;
        }

        .final-screen.show {
            display: block;
        }

        .final-screen h2 {
            color: #e6b980;
            font-size: 22px;
            margin-bottom: 20px;
            text-shadow: 0 0 20px rgba(230, 185, 128, 0.6);
        }

        .selected-cards-display {
            display: flex;
            justify-content: center;
            gap: 12px;
            margin: 25px 0;
        }

        .mini-card {
            width: 70px;
            height: 105px;
            border-radius: 8px;
            border: 2px solid #e6b980;
            box-shadow: 0 0 20px rgba(230, 185, 128, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 36px;
            background: linear-gradient(135deg, #4a2c5e 0%, #2d1b4e 100%);
            overflow: hidden;
        }

        .mini-card img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        /* –ê–¥–∞–ø—Ç–∞—Ü–∏—è –¥–ª—è –º–∞–ª–µ–Ω—å–∫–∏—Ö —ç–∫—Ä–∞–Ω–æ–≤ */
        @media (max-width: 380px) {
            .title { font-size: 18px; }
            .grid { gap: 6px; max-width: 320px; }
            .card-back { font-size: 24px; }
            .card-front { font-size: 30px; }
            .message { font-size: 14px; }
        }
    </style>
</head>
<body>
<div class="container">
    <h1 class="title" id="title">‚ú® –ü–µ—Ä–µ—Ç–∞—Å–æ–≤—ã–≤–∞—é –∫–∞—Ä—Ç—ã... ‚ú®</h1>

    <div class="shuffle-area" id="shuffleArea">
        <div class="shuffle-card">üåô</div>
        <div class="shuffle-card">üåô</div>
        <div class="shuffle-card">üåô</div>
        <div class="shuffle-card">üåô</div>
        <div class="shuffle-card">üåô</div>
    </div>

    <div class="grid" id="grid"></div>

    <div class="final-screen" id="finalScreen">
        <h2>‚ú® –ö–∞—Ä—Ç—ã –≤—ã–±—Ä–∞–Ω—ã! ‚ú®</h2>
        <div class="selected-cards-display" id="selectedCardsDisplay"></div>
        <p class="message">–û—Ç–ø—Ä–∞–≤–ª—è—é —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ç—ë—Ç–µ –ó–∏–Ω–µ...</p>
    </div>

    <div class="message" id="message"></div>
</div>

<script>
    // === –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø ===
    const TOTAL_CARDS = 78;
    const CARDS_TO_SHOW = 9;
    const CARDS_TO_SELECT = 3;

    // üÉè –ü–£–¢–ò –ö –ò–ó–û–ë–†–ê–ñ–ï–ù–ò–Ø–ú –ö–ê–†–¢ –¢–ê–†–û (78 —à—Ç—É–∫)
    // –ù–∞–∑–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤ –¥–æ–ª–∂–Ω—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –∏–Ω–¥–µ–∫—Å–∞–º 0-77
    const CARD_IMAGES = [
        // –°—Ç–∞—Ä—à–∏–µ –ê—Ä–∫–∞–Ω—ã (0-21)
        'images/cards/00-fool.jpg',
        'images/cards/01-magician.jpg',
        'images/cards/02-high-priestess.jpg',
        'images/cards/03-empress.jpg',
        'images/cards/04-emperor.jpg',
        'images/cards/05-hierophant.jpg',
        'images/cards/06-lovers.jpg',
        'images/cards/07-chariot.jpg',
        'images/cards/08-strength.jpg',
        'images/cards/09-hermit.jpg',
        'images/cards/10-wheel.jpg',
        'images/cards/11-justice.jpg',
        'images/cards/12-hanged.jpg',
        'images/cards/13-death.jpg',
        'images/cards/14-temperance.jpg',
        'images/cards/15-devil.jpg',
        'images/cards/16-tower.jpg',
        'images/cards/17-star.jpg',
        'images/cards/18-moon.jpg',
        'images/cards/19-sun.jpg',
        'images/cards/20-judgement.jpg',
        'images/cards/21-world.jpg',

        // –ñ–µ–∑–ª—ã (22-35)
        'images/cards/22-wands-ace.jpg',
        'images/cards/23-wands-02.jpg',
        'images/cards/24-wands-03.jpg',
        'images/cards/25-wands-04.jpg',
        'images/cards/26-wands-05.jpg',
        'images/cards/27-wands-06.jpg',
        'images/cards/28-wands-07.jpg',
        'images/cards/29-wands-08.jpg',
        'images/cards/30-wands-09.jpg',
        'images/cards/31-wands-10.jpg',
        'images/cards/32-wands-page.jpg',
        'images/cards/33-wands-knight.jpg',
        'images/cards/34-wands-queen.jpg',
        'images/cards/35-wands-king.jpg',

        // –ö—É–±–∫–∏ (36-49)
        'images/cards/36-cups-ace.jpg',
        'images/cards/37-cups-02.jpg',
        'images/cards/38-cups-03.jpg',
        'images/cards/39-cups-04.jpg',
        'images/cards/40-cups-05.jpg',
        'images/cards/41-cups-06.jpg',
        'images/cards/42-cups-07.jpg',
        'images/cards/43-cups-08.jpg',
        'images/cards/44-cups-09.jpg',
        'images/cards/45-cups-10.jpg',
        'images/cards/46-cups-page.jpg',
        'images/cards/47-cups-knight.jpg',
        'images/cards/48-cups-queen.jpg',
        'images/cards/49-cups-king.jpg',

        // –ú–µ—á–∏ (50-63)
        'images/cards/50-swords-ace.jpg',
        'images/cards/51-swords-02.jpg',
        'images/cards/52-swords-03.jpg',
        'images/cards/53-swords-04.jpg',
        'images/cards/54-swords-05.jpg',
        'images/cards/55-swords-06.jpg',
        'images/cards/56-swords-07.jpg',
        'images/cards/57-swords-08.jpg',
        'images/cards/58-swords-09.jpg',
        'images/cards/59-swords-10.jpg',
        'images/cards/60-swords-page.jpg',
        'images/cards/61-swords-knight.jpg',
        'images/cards/62-swords-queen.jpg',
        'images/cards/63-swords-king.jpg',

        // –ü–µ–Ω—Ç–∞–∫–ª–∏ (64-77)
        'images/cards/64-pentacles-ace.jpg',
        'images/cards/65-pentacles-02.jpg',
        'images/cards/66-pentacles-03.jpg',
        'images/cards/67-pentacles-04.jpg',
        'images/cards/68-pentacles-05.jpg',
        'images/cards/69-pentacles-06.jpg',
        'images/cards/70-pentacles-07.jpg',
        'images/cards/71-pentacles-08.jpg',
        'images/cards/72-pentacles-09.jpg',
        'images/cards/73-pentacles-10.jpg',
        'images/cards/74-pentacles-page.jpg',
        'images/cards/75-pentacles-knight.jpg',
        'images/cards/76-pentacles-queen.jpg',
        'images/cards/77-pentacles-king.jpg'
    ];

    const ALL_CARDS = Array.from({length: TOTAL_CARDS}, (_, i) => i);
    const CARD_EMOJIS = ['üåô', '‚≠ê', '‚ú®', 'üîÆ', 'üåü', 'üí´', 'ü™ê', '‚òÑ', 'üå†'];

    let selectedGrid = [];
    let selectedCards = [];
    let selectedIndices = [];
    let isLocked = false;
    let isGridReady = false;

    // === –§–£–ù–ö–¶–ò–ò ===

    function shuffleArray(array) {
        const shuffled = [...array];
        for (let i = shuffled.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
        }
        return shuffled;
    }

    function selectRandomCards() {
        const shuffled = shuffleArray(ALL_CARDS);
        selectedGrid = shuffled.slice(0, CARDS_TO_SHOW);
        console.log('–í—ã–±—Ä–∞–Ω–Ω—ã–µ –∫–∞—Ä—Ç—ã –¥–ª—è —Å–µ—Ç–∫–∏:', selectedGrid);
    }

    function createGrid() {
        const grid = document.getElementById('grid');
        grid.innerHTML = '';

        selectedGrid.forEach((cardId, index) => {
            const container = document.createElement('div');
            container.className = 'card-container';
            container.dataset.index = index;
            container.dataset.cardId = cardId;

            // –†—É–±–∞—à–∫–∞
            const back = document.createElement('div');
            back.className = 'card-back';
            back.textContent = 'üåô'; // –ó–∞–º–µ–Ω–∏—Ç—Å—è –Ω–∞ background-image –≤ CSS

            // –õ–∏—Ü–æ –∫–∞—Ä—Ç—ã
            const front = document.createElement('div');
            front.className = 'card-front';

            // üÉè –ï—Å–ª–∏ –µ—Å—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ - –∏—Å–ø–æ–ª—å–∑—É–µ–º –µ–≥–æ
            const cardImage = CARD_IMAGES[cardId];
            if (cardImage) {
                const img = document.createElement('img');
                img.src = cardImage;
                img.alt = `Card ${cardId}`;
                img.onerror = function() {
                    // –ï—Å–ª–∏ –∫–∞—Ä—Ç–∏–Ω–∫–∞ –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª–∞—Å—å - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —ç–º–æ–¥–∑–∏
                    this.style.display = 'none';
                    const emoji = document.createElement('span');
                    emoji.className = 'emoji-placeholder';
                    emoji.textContent = CARD_EMOJIS[index];
                    front.appendChild(emoji);
                };
                front.appendChild(img);
            } else {
                // –ó–∞–ø–∞—Å–Ω–æ–π –≤–∞—Ä–∏–∞–Ω—Ç - —ç–º–æ–¥–∑–∏
                const emoji = document.createElement('span');
                emoji.className = 'emoji-placeholder';
                emoji.textContent = CARD_EMOJIS[index];
                front.appendChild(emoji);
            }

            const number = document.createElement('span');
            number.className = 'card-number';
            number.textContent = index + 1;
            front.appendChild(number);

            container.appendChild(back);
            container.appendChild(front);

            container.addEventListener('click', () => handleCardClick(container, index, cardId));

            grid.appendChild(container);
        });
    }

    function handleCardClick(container, index, cardId) {
        if (isLocked || !isGridReady) return;

        const indexInSelectedIndices = selectedIndices.indexOf(index);
        const isSelected = indexInSelectedIndices !== -1;

        if (isSelected) {
            container.classList.remove('flipped', 'selected');
            selectedIndices.splice(indexInSelectedIndices, 1);

            const cardIdIndex = selectedCards.indexOf(cardId);
            if (cardIdIndex !== -1) {
                 selectedCards.splice(cardIdIndex, 1);
            }

        } else if (selectedIndices.length < CARDS_TO_SELECT) {
            container.classList.add('flipped');
            setTimeout(() => {
                container.classList.add('selected');
            }, 300);

            selectedIndices.push(index);
            selectedCards.push(cardId);
        }

        updateMessage();

        if (selectedIndices.length === CARDS_TO_SELECT) {
            finishSelection();
        }
    }

    function updateMessage() {
        const message = document.getElementById('message');
        const remaining = CARDS_TO_SELECT - selectedCards.length;

        if (remaining === CARDS_TO_SELECT) {
            message.textContent = '–°–ª—É—à–∞–π —Å–µ—Ä–¥—Ü–µ–º... –í—ã–±–µ—Ä–∏ 3 –∫–∞—Ä—Ç—ã';
        } else if (remaining > 0) {
            message.textContent = `–í—ã–±—Ä–∞–Ω–æ: ${selectedCards.length} –∏–∑ ${CARDS_TO_SELECT}`;
        } else {
            message.textContent = '';
        }
    }

    function finishSelection() {
        isLocked = true;

        if (window.Telegram && window.Telegram.WebApp) {
            window.Telegram.WebApp.MainButton.hide();
        }

        document.querySelectorAll('.card-container').forEach(card => {
            if (!selectedIndices.includes(parseInt(card.dataset.index))) {
                card.classList.add('locked');
            }
        });

        document.getElementById('message').textContent = '‚ú® –í–∞—à –≤—ã–±–æ—Ä —Å–¥–µ–ª–∞–Ω! ‚ú®';
        document.getElementById('message').classList.add('success');

        setTimeout(showFinalScreen, 1000);
    }

    function showFinalScreen() {
        document.getElementById('grid').style.display = 'none';
        document.getElementById('message').style.display = 'none';

        const finalScreen = document.getElementById('finalScreen');
        const display = document.getElementById('selectedCardsDisplay');
        display.innerHTML = '';

        selectedIndices.forEach((index) => {
            const cardId = selectedGrid[index];
            const miniCard = document.createElement('div');
            miniCard.className = 'mini-card';

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–ª–∏ —ç–º–æ–¥–∑–∏
            const cardImage = CARD_IMAGES[cardId];
            if (cardImage) {
                const img = document.createElement('img');
                img.src = cardImage;
                img.onerror = function() {
                    miniCard.textContent = CARD_EMOJIS[index];
                };
                miniCard.appendChild(img);
            } else {
                miniCard.textContent = CARD_EMOJIS[index];
            }

            display.appendChild(miniCard);
        });

        finalScreen.classList.add('show');

        setTimeout(sendToBot, 2000);
    }

    function sendToBot() {
        const positions = selectedIndices.map(i => i + 1);

        const result = {
            cards: positions,
            picks: positions,
            selected: positions,
            grid: selectedGrid,
            timestamp: new Date().toISOString()
        };

        console.log('–û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ –±–æ—Ç–∞:', result);

        if (window.Telegram && window.Telegram.WebApp) {
            window.Telegram.WebApp.sendData(JSON.stringify(result));

            setTimeout(() => {
                window.Telegram.WebApp.close();
            }, 500);
        } else {
            alert('–¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º. –î–∞–Ω–Ω—ã–µ:\n' + JSON.stringify(result, null, 2));
            console.log('–†–µ–∑—É–ª—å—Ç–∞—Ç:', result);
        }
    }

    function createSparkles() {
        for (let i = 0; i < 10; i++) {
            setTimeout(() => {
                const sparkle = document.createElement('div');
                sparkle.className = 'sparkle';
                sparkle.style.left = Math.random() * 100 + '%';
                sparkle.style.top = Math.random() * 100 + '%';
                sparkle.style.animationDelay = Math.random() * 2 + 's';
                document.body.appendChild(sparkle);

                setTimeout(() => sparkle.remove(), 2000);
            }, i * 100);
        }
    }

    // === –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ===
    setTimeout(() => {
        const shuffleArea = document.getElementById('shuffleArea');
        shuffleArea.classList.add('hidden');

        document.getElementById('title').textContent = 'üé¥ –í—ã–±–µ—Ä–∏ 3 –∫–∞—Ä—Ç—ã üé¥';

        selectRandomCards();
        createGrid();

        document.getElementById('grid').classList.add('show');
        updateMessage();
        isGridReady = true;

        console.log('–°–µ—Ç–∫–∞ –≥–æ—Ç–æ–≤–∞, –æ–∂–∏–¥–∞–Ω–∏–µ –≤—ã–±–æ—Ä–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è');
    }, 2500);

    createSparkles();
    setInterval(createSparkles, 3000);

    if (window.Telegram && window.Telegram.WebApp) {
        const tg = window.Telegram.WebApp;
        tg.expand();
        tg.enableClosingConfirmation();
    }
</script>
</body>
</html>
